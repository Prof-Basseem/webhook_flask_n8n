{% extends "base.html" %}

{% block title %}Send Messages | n8n Webhook Integration{% endblock %}

{% block description %}Send messages to n8n workflow automation{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/index.css') }}">
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/index.js') }}"></script>
{% endblock %}

{% block content %}
<div class="container">
    <h1><i class="fas fa-paper-plane"></i> Send Message to n8n</h1>
    <p class="subtitle">Send data to your n8n workflow and receive responses back</p>

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="alert {{ category }}">
            {% if category == 'success' %}
              <i class="fas fa-check-circle"></i>
            {% else %}
              <i class="fas fa-exclamation-triangle"></i>
            {% endif %}
            {{ message }}
          </div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    <div class="features-grid">
        <div class="feature-card">
            <div class="feature-content">
                <h2><i class="fas fa-rocket"></i> Send to n8n</h2>
                <p>Send messages directly to your n8n workflow using the form below.</p>
                
                <form method="post" id="webhookForm" enctype="application/x-www-form-urlencoded">
                    <div class="form-group">
                        <label for="name">
                            <i class="fas fa-user form-icon"></i>Your Name
                        </label>
                        <input type="text" id="name" name="name" placeholder="Enter your name" required>
                    </div>

                    <div class="form-group">
                        <label for="message">
                            <i class="fas fa-comment form-icon"></i>Your Message
                        </label>
                        <textarea id="message" name="message" placeholder="Type your message here..." required></textarea>
                    </div>

                    <button type="submit" class="btn" id="submitBtn">
                        <span><i class="fas fa-rocket"></i> Send to n8n Workflow</span>
                    </button>
                </form>
            </div>
            <div class="webhook-info">
                <h3>Webhook URL</h3>
                <div class="feature-content">
                <h2><i class="fas fa-database" ></i> View Data</h2>
                <p>Check all the messages that have been sent to your n8n workflow.</p>
                <a href="{{ url_for('view_data') }}" class="btn btn-secondary" style="background-color: aliceblue;" target="_blank">
                    <i class="fas fa-eye" style="color: black;"></i>
                    <span style="color: black;">View Received Data</span>
                </a>
            </div>

        </div>
      
    </div>
</div>
{% endblock %}
